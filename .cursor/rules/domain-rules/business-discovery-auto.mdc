---
description: Business goal discovery workflow - maps business goals to MaKo processes and implementation steps
globs:
  - "**/BUSINESS_PROCESS_MAP.md"
  - "**/PROCESS_GRAPH.json"
  - "backend/**/*"
  - "src/**/*"
  - "services/**/*"
alwaysApply: false
tags: [business, discovery, workflow, entry-point-1]
priority: 2
version: 1.0.0
---

# Business Goal Discovery - Entry Point 1

## When to Use This Rule

Apply when user asks about:
- Business goals (e.g., "register customer", "cancel contract", "change supplier")
- Understanding what processes are needed for a business scenario
- Designing backend services for a business workflow
- "What do I need to do for X business scenario?"

## Workflow: Business Goal → Implementation

### Step 1: Start with BUSINESS_PROCESS_MAP.md

**ALWAYS START HERE** for business discovery tasks.

**CRITICAL**: Read the actual file - never guess or assume process mappings.

<example>
**User**: "I want to register a new customer"

**Agent Action**:
1. **READ** BUSINESS_PROCESS_MAP.md (verify actual content)
2. **READ** PROCESS_GRAPH.json (verify process details)
3. Find scenario: "New Customer Signs Up" (cite source)
4. Identify required processes: MaloIdent → Lieferbeginn (from verified sources)
5. **Verify** dependencies in PROCESS_GRAPH.json
6. **Cite sources** in response
7. **Create visualization** showing the process sequence (based on verified data)
</example>

### Step 2: Use PROCESS_GRAPH.json

Query `PROCESS_GRAPH.json` for:
- Process sequences and dependencies (what triggers what)
- Business scenarios with step-by-step sequences
- Fast lookup by trigger event, pruefi, or role
- Understanding prerequisites and outcomes

<example>
**Lookup Pattern**:
```json
{
  "processes": {
    "LIEFERBEGINN": {
      "prerequisites": ["MALOIDENT"],
      "triggers_processes": ["STAMMDATENAENDERUNG"],
      "business_scenarios": ["new_customer_signup"]
    }
  }
}
```
</example>

### Step 3: Create Process Visualization

**MANDATORY**: Always create visualizations (see visualization-rules/process-visualization-mandatory-always.mdc)

Include:
- Sequence diagram showing process flow
- Flowchart showing dependencies
- Table of message types and fields
- Example message references

### Step 4: Reference Documentation

Use this sequence:
1. `llm.txt` - Find which documentation files you need
2. `docs-offline/` - Read workflow documentation (232 files, including Prozessübersicht)
3. `docs-offline/enhanced-index.json` - Programmatic BDEW ID → filename lookup (optional)

### Step 5: Check Examples

Reference real-world examples:
- `maco-edi-testfiles/inbound/` - Example inbound messages (responses from market) - JSON format shows BO4E structure
- `maco-edi-testfiles/outbound/` - Example outbound messages (requests to market) - JSON format shows BO4E structure

### Step 6: Build Implementation

Cross-reference:
- Business rules: `maco-api-documentation/pythons/createPiFromTemplater/templater/yaml_output/[ID].yaml`
- API schemas: `maco-api-documentation/macoapp-schreiben/components/requestBodies/PIs/PI_[ID].yml`
- BO4E types: `maco-api-documentation/_build/bo4e-openapi.min.json`

## Common Business Scenarios

<valid-example>
**Scenario**: New Customer Registration
1. Customer doesn't know MaLo-ID → Use MaloIdent process
2. After MaloIdent success → Trigger Lieferbeginn (55077)
3. Check PROCESS_GRAPH.json for prerequisites and next steps
4. **Create visualization** showing full sequence
5. Implement webhook handlers for inbound responses
</valid-example>

<invalid-example>
**Don't**: Start implementing without checking BUSINESS_PROCESS_MAP.md
**Don't**: Skip dependency checking in PROCESS_GRAPH.json
**Don't**: Ignore prerequisites - processes have strict order requirements
**Don't**: Skip visualization creation
</invalid-example>

## Always Check Dependencies

Before implementing any process:
1. Check `PROCESS_GRAPH.json` for prerequisites
2. Verify all prerequisites are met or can be triggered
3. Understand what processes this triggers next
4. Plan webhook handlers for all expected responses
5. **Create visualization** of the complete flow
