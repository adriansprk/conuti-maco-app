{
  "$schema": "./schemas/process-graph-schema.json",
  "version": "1.0.0",
  "generated": "2024-12-11",
  "description": "Machine-readable process dependency graph for MaCo API. Extracted from docs-offline Mermaid diagrams.",

  "processes": {
    "MALOIDENT": {
      "id": "MALOIDENT",
      "name": "MaLo-Ident (Rolle LF)",
      "name_de": "Marktlokations-Identifikation",
      "description": "Identify market location (MaLo) when customer doesn't know their MaLo-ID",
      "trigger": "START_MALOIDENT",
      "role": "LF",
      "documentation": {
        "process": "docs-offline/malo-ident-rolle-lf-3312793f0.md",
        "prozessuebersicht": "docs-offline/prozessübersicht-892746m0.md"
      },
      "api": {
        "outbound": {
          "schema": "maloident-macoapp.min.json",
          "endpoint": "/maloId/request/v1"
        },
        "inbound": {
          "schema": "maloident-lieferant.min.json",
          "webhooks": [
            "/maloId/dataForMarketLocationPositive/v1",
            "/maloId/dataForMarketLocationNegative/v1"
          ]
        }
      },
      "pruefis": {},
      "prerequisites": [],
      "triggers_processes": [],
      "outcomes": {
        "success": {
          "webhook": "/maloId/dataForMarketLocationPositive/v1",
          "provides": ["marktlokationsId", "marktlokation_stammdaten"],
          "enables": ["LIEFERBEGINN"]
        },
        "rejection": {
          "webhook": "/maloId/dataForMarketLocationNegative/v1",
          "ebd": ["E_0594"]
        }
      }
    },

    "LIEFERBEGINN": {
      "id": "LIEFERBEGINN",
      "name": "Lieferbeginn (Rolle LFN)",
      "name_de": "Lieferbeginn - Anmeldung Zuordnung",
      "description": "Register customer's supply contract with network operator (consuming or generating Marktlokation)",
      "trigger": "START_LIEFERBEGINN",
      "role": "LFN",
      "documentation": {
        "process": "docs-offline/lieferbeginn.md",
        "prozessuebersicht": "docs-offline/prozessübersicht-853953m0.md"
      },
      "api": {
        "outbound": {
          "schema": "macoapp-trigger.min.json",
          "trigger_event": "START_LIEFERBEGINN"
        },
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "request": "55001",
        "request_erzeugend": "55077",
        "success": "55002",
        "success_erzeugend": "55078",
        "rejection": "55003",
        "rejection_erzeugend": "55080",
        "info_existing_assignment": "55036",
        "anfrage_beendigung_lfa": "55010",
        "antwort_beendigung_lfa": ["55011", "55012"]
      },
      "prerequisites": [
        {
          "process": "MALOIDENT",
          "condition": "when marktlokationsId is unknown",
          "required": "conditional"
        }
      ],
      "triggers_processes": [
        {
          "process": "ABRECHNUNGSDATEN_NN",
          "condition": "on success, for consuming Marktlokation",
          "pruefi": "55218",
          "timing": "immediate",
          "triggered_by": "NB"
        },
        {
          "process": "ABRECHNUNGSDATEN_BK",
          "condition": "on success, always",
          "pruefi": "55126",
          "timing": "immediate",
          "triggered_by": "NB"
        },
        {
          "process": "STAMMDATENAENDERUNG_NB",
          "condition": "on success, always",
          "pruefi": ["55615", "55620", "55175", "55225", "55616", "55617", "55618", "55619", "55691"],
          "timing": "immediate",
          "triggered_by": "NB"
        },
        {
          "process": "BEENDIGUNG_ZUORDNUNG_LFA",
          "condition": "when existing LFA assignment, after LFA confirms",
          "pruefi": "55037",
          "timing": "immediate",
          "triggered_by": "NB"
        },
        {
          "process": "AUFHEBUNG_ZUORDNUNG_LFZ",
          "condition": "when overriding future LFZ assignment",
          "pruefi": "55038",
          "timing": "immediate",
          "triggered_by": "NB"
        },
        {
          "process": "BERECHNUNGSFORMEL",
          "condition": "on success",
          "pruefi": "25001",
          "timing": "dependent_on_zuordnungsbeginn",
          "triggered_by": "NB"
        },
        {
          "process": "EINRICHTUNG_KONFIG",
          "condition": "on success",
          "pruefi": "17134",
          "timing": "dependent_on_zuordnungsbeginn",
          "triggered_by": "NB"
        },
        {
          "process": "ERSATZ_GRUNDVERSORGUNG",
          "condition": "on success, for consuming Marktlokation when E/G required",
          "pruefi": "55013",
          "timing": "dependent_on_zuordnungsbeginn",
          "triggered_by": "NB"
        },
        {
          "process": "WIEDERHERSTELLUNG_ANSCHLUSS",
          "condition": "on success, for blocked Marktlokation",
          "pruefi": ["21040", "21039"],
          "timing": "dependent_on_zuordnungsbeginn",
          "triggered_by": "NB"
        }
      ],
      "outcomes": {
        "success": {
          "pruefi": ["55002", "55078"],
          "description": "Zuordnung des LFN zur Marktlokation bzw. Tranche"
        },
        "rejection": {
          "pruefi": ["55003", "55080"],
          "ebd": ["E_0621", "E_0622", "E_0623"],
          "description": "Ablehnung der Anmeldung"
        },
        "info_existing": {
          "pruefi": "55036",
          "description": "NB informs about existing LFA assignment, triggers Anfrage zur Beendigung"
        }
      }
    },

    "KUENDIGUNG_LFA": {
      "id": "KUENDIGUNG_LFA",
      "name": "Kündigung LFA",
      "name_de": "Kündigung (Altlieferant-Perspektive)",
      "description": "Receive and respond to cancellation from new supplier (LFN). You are the old supplier (LFA).",
      "trigger": null,
      "role": "LFA",
      "documentation": {
        "process": "docs-offline/kündigung-lfa-3118804f0.md",
        "prozessuebersicht": "docs-offline/prozessübersicht-860885m0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json",
          "description": "Receive cancellation request from LFN"
        }
      },
      "pruefis": {
        "request_from_lfn": "55016",
        "response_success": "55017",
        "response_rejection": "55018"
      },
      "prerequisites": [],
      "triggers_processes": [
        {
          "process": "LIEFERENDE_LF_NB",
          "condition": "when cancellation confirmed and Lieferende not yet started",
          "pruefi": "55004",
          "timing": "at_contract_end",
          "triggered_by": "self"
        }
      ],
      "outcomes": {
        "success": {
          "pruefi": "55017",
          "description": "Cancellation confirmed"
        },
        "rejection": {
          "pruefi": "55018",
          "ebd": ["E_0614"],
          "description": "Cancellation rejected"
        }
      }
    },

    "KUENDIGUNG_LFN": {
      "id": "KUENDIGUNG_LFN",
      "name": "Kündigung LFN",
      "name_de": "Kündigung (Neulieferant-Perspektive)",
      "description": "Send cancellation to old supplier (LFA) on customer's behalf. You are the new supplier (LFN).",
      "trigger": "START_KUENDIGUNG",
      "role": "LFN",
      "documentation": {
        "process": "docs-offline/kündigung-lfn-3118848f0.md",
        "prozessuebersicht": "docs-offline/prozessübersicht-860891m0.md"
      },
      "api": {
        "outbound": {
          "schema": "macoapp-trigger.min.json",
          "trigger_event": "START_KUENDIGUNG"
        }
      },
      "pruefis": {
        "request": "55016",
        "response_success": "55017",
        "response_rejection": "55018"
      },
      "prerequisites": [
        {
          "process": "MALOIDENT",
          "condition": "when marktlokationsId is unknown",
          "required": "conditional"
        }
      ],
      "triggers_processes": [],
      "outcomes": {
        "success": {
          "pruefi": "55017",
          "description": "LFA confirms cancellation",
          "enables": ["LIEFERBEGINN"]
        },
        "rejection": {
          "pruefi": "55018",
          "ebd": ["E_0614"],
          "description": "LFA rejects cancellation"
        }
      }
    },

    "LIEFERENDE_LF_NB": {
      "id": "LIEFERENDE_LF_NB",
      "name": "Lieferende LF -> NB (Rolle LF)",
      "name_de": "Lieferende - Abmeldung vom LF an NB",
      "description": "End supply assignment - notification from supplier to network operator",
      "trigger": "START_LIEFERENDE",
      "role": "LF",
      "documentation": {
        "process": "docs-offline/lieferende-lf-nb-rolle-lf-3119196f0.md"
      },
      "api": {
        "outbound": {
          "schema": "macoapp-trigger.min.json",
          "trigger_event": "START_LIEFERENDE"
        }
      },
      "pruefis": {
        "request": "55004",
        "success": "55037",
        "rejection": "55006"
      },
      "prerequisites": [
        {
          "process": "KUENDIGUNG_LFA",
          "condition": "typically follows confirmed cancellation",
          "required": "typical"
        }
      ],
      "triggers_processes": [
        {
          "process": "ABRECHNUNGSDATEN_NN",
          "condition": "on success, for consuming Marktlokation",
          "pruefi": "55218",
          "timing": "immediate",
          "triggered_by": "NB"
        },
        {
          "process": "ABRECHNUNGSDATEN_BK",
          "condition": "on success, always",
          "pruefi": "55126",
          "timing": "immediate",
          "triggered_by": "NB"
        },
        {
          "process": "LIEFERENDE_NB_LF",
          "condition": "when NB determines Stilllegung",
          "pruefi": "55007",
          "timing": "immediate",
          "triggered_by": "NB"
        },
        {
          "process": "ERSATZ_GRUNDVERSORGUNG",
          "condition": "for consuming Marktlokation when E/G required",
          "pruefi": "55013",
          "timing": "dependent_on_zuordnungsende",
          "triggered_by": "NB"
        }
      ],
      "outcomes": {
        "success": {
          "pruefi": "55037",
          "description": "Beendigung der Zuordnung des LF zur Marktlokation bzw. Tranche"
        },
        "rejection": {
          "pruefi": "55006",
          "description": "Ablehnung der Abmeldung"
        }
      }
    },

    "LIEFERENDE_NB_LF": {
      "id": "LIEFERENDE_NB_LF",
      "name": "Lieferende NB -> LF (Rolle LF)",
      "name_de": "Lieferende - Ankündigung vom NB an LF",
      "description": "Receive end-of-supply announcement from network operator (e.g., for Stilllegung)",
      "trigger": null,
      "role": "LF",
      "documentation": {
        "process": "docs-offline/lieferende-nb-lf-rolle-lf-3129676f0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "announcement": "55007",
        "response_accept": "55008",
        "response_reject": "55009",
        "forced_termination": "55037"
      },
      "prerequisites": [],
      "triggers_processes": [
        {
          "process": "ABRECHNUNGSDATEN_NN",
          "condition": "on termination, for consuming Marktlokation",
          "pruefi": "55218",
          "timing": "immediate",
          "triggered_by": "NB"
        },
        {
          "process": "ABRECHNUNGSDATEN_BK",
          "condition": "on termination, always",
          "pruefi": "55126",
          "timing": "immediate",
          "triggered_by": "NB"
        },
        {
          "process": "ERSATZ_GRUNDVERSORGUNG",
          "condition": "for consuming Marktlokation when E/G required",
          "pruefi": "55013",
          "timing": "dependent_on_zuordnungsende",
          "triggered_by": "NB"
        }
      ],
      "outcomes": {
        "acknowledged": {
          "pruefi": ["55008", "55009"],
          "description": "LF responds to announcement"
        },
        "forced": {
          "pruefi": "55037",
          "description": "Termination due to no timely response"
        }
      }
    },

    "ABMELDEANFRAGE_NB_LFA": {
      "id": "ABMELDEANFRAGE_NB_LFA",
      "name": "Abmeldeanfrage NB -> LF (Rolle LFA)",
      "name_de": "Abmeldeanfrage - Anfrage zur Beendigung der Zuordnung",
      "description": "Receive request from NB to end assignment (triggered during Lieferbeginn by new supplier)",
      "trigger": null,
      "role": "LFA",
      "documentation": {
        "process": "docs-offline/abmeldeanfrage-nb-lf-rolle-lfa-3118774f0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "request": "55010",
        "response_accept": "55011",
        "response_reject": "55012"
      },
      "prerequisites": [],
      "triggers_processes": [],
      "outcomes": {
        "accepted": {
          "pruefi": "55011",
          "description": "LFA confirms end of assignment"
        },
        "rejected": {
          "pruefi": "55012",
          "ebd": ["E_0624"],
          "description": "LFA rejects end of assignment"
        }
      }
    },

    "STORNIERUNG": {
      "id": "STORNIERUNG",
      "name": "Anfrage nach Stornierung (Rolle LF)",
      "name_de": "Stornierung",
      "description": "Request cancellation/reversal of a previously sent message",
      "trigger": "START_STORNIERUNG",
      "role": "LF",
      "documentation": {
        "process": "docs-offline/stornierung-5000861f0.md",
        "prozessuebersicht": "docs-offline/prozessübersicht-1621227m0.md"
      },
      "api": {
        "outbound": {
          "schema": "macoapp-trigger.min.json",
          "trigger_event": "START_STORNIERUNG"
        }
      },
      "pruefis": {
        "request": "55022",
        "response_success": "55023",
        "response_rejection": "55024"
      },
      "prerequisites": [],
      "triggers_processes": [],
      "outcomes": {
        "success": {
          "pruefi": "55023",
          "description": "Stornierung accepted"
        },
        "rejection": {
          "pruefi": "55024",
          "description": "Stornierung rejected"
        }
      }
    },

    "STAMMDATENAENDERUNG_LF": {
      "id": "STAMMDATENAENDERUNG_LF",
      "name": "Stammdatenänderung vom Lieferanten (verantwortlich)",
      "name_de": "Stammdatenänderung - vom LF ausgehend",
      "description": "Send master data changes from responsible supplier to market partners",
      "trigger": "START_VERSAND_SDAE",
      "role": "LF",
      "documentation": {
        "process": "docs-offline/stammdatenänderung-vom-lieferanten-verantwortlich-15239974e0.md"
      },
      "api": {
        "outbound": {
          "schema": "macoapp-trigger.min.json",
          "trigger_event": "START_VERSAND_SDAE"
        }
      },
      "pruefis": {
        "note": "Various pruefis depending on data type changed"
      },
      "prerequisites": [],
      "triggers_processes": [],
      "outcomes": {
        "success": {
          "description": "Market partners acknowledge changes"
        },
        "rejection": {
          "description": "Market partners reject changes"
        }
      }
    },

    "STAMMDATENAENDERUNG_NB": {
      "id": "STAMMDATENAENDERUNG_NB",
      "name": "Stammdatenänderung vom Netzbetreiber (verantwortlich) (Rolle LF)",
      "name_de": "Stammdatenänderung - vom NB eingehend",
      "description": "Receive master data changes from network operator",
      "trigger": null,
      "role": "LF",
      "documentation": {
        "process": "docs-offline/stammdatenänderung-vom-netzbetreiber-verantwortlich-rolle-lf-3130230f0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "incoming": ["55615", "55616", "55619", "55617", "55618", "55620", "55225", "55175"],
        "response": ["55621", "55622", "55625", "55623", "55624", "55626", "55227", "55180"],
        "processing_status": "21047"
      },
      "prerequisites": [],
      "triggers_processes": [],
      "outcomes": {
        "acknowledged": {
          "description": "LF confirms receipt and accepts/rejects changes"
        }
      }
    },

    "STAMMDATENAENDERUNG_MSB": {
      "id": "STAMMDATENAENDERUNG_MSB",
      "name": "Stammdatenänderung vom MSB (verantwortlich) (Rolle LF)",
      "name_de": "Stammdatenänderung - vom MSB eingehend",
      "description": "Receive master data changes from meter operator",
      "trigger": null,
      "role": "LF",
      "documentation": {
        "process": "docs-offline/stammdatenänderung-vom-msb-verantwortlich-rolle-lf-3130254f0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "note": "Various pruefis depending on data type"
      },
      "prerequisites": [],
      "triggers_processes": [],
      "outcomes": {
        "acknowledged": {
          "description": "LF confirms receipt"
        }
      }
    },

    "ABRECHNUNGSDATEN_NN": {
      "id": "ABRECHNUNGSDATEN_NN",
      "name": "Abrechnungsdaten Netznutzungsabrechnung (Rolle LF)",
      "name_de": "Abrechnungsdaten Netznutzung",
      "description": "Receive network usage billing data from network operator",
      "trigger": null,
      "role": "LF",
      "documentation": {
        "process": "docs-offline/abrechnungsdaten-netznutzungsabrechnung-rolle-lf-3130129f0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "incoming": "55218",
        "response": "55220",
        "processing_status": "21047"
      },
      "prerequisites": [],
      "triggers_processes": [
        {
          "process": "UEBERMITTLUNG_ARBEITS_LEISTUNGSWERTE",
          "condition": "for unterjährige Zuordnung with Arbeits- und Leistungspreis",
          "pruefi": "13015",
          "triggered_by": "NB"
        }
      ],
      "outcomes": {
        "acknowledged": {
          "pruefi": "55220",
          "description": "LF confirms receipt or disputes content"
        }
      }
    },

    "ABRECHNUNGSDATEN_BK": {
      "id": "ABRECHNUNGSDATEN_BK",
      "name": "Abrechnungsdaten Bilanzkreisabrechnung (Rolle LF)",
      "name_de": "Abrechnungsdaten Bilanzkreis",
      "description": "Receive balance group billing data from network operator",
      "trigger": null,
      "role": "LF",
      "documentation": {
        "process": "docs-offline/abrechnungsdaten-bilanzkreisabrechnung-rolle-lf-3130133f0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "incoming": ["55126", "55672"],
        "response": ["55156", "55673"],
        "processing_status": "21047"
      },
      "prerequisites": [],
      "triggers_processes": [
        {
          "process": "STAMMDATENAENDERUNG_NB",
          "condition": "when data for Ersatzwertbildung changes",
          "pruefi": "55627",
          "triggered_by": "NB"
        }
      ],
      "outcomes": {
        "acknowledged": {
          "description": "LF confirms receipt or disputes content"
        }
      }
    },

    "BERECHNUNGSFORMEL": {
      "id": "BERECHNUNGSFORMEL",
      "name": "Berechnungsformel (Rolle LF)",
      "name_de": "Berechnungsformel",
      "description": "Receive calculation formula from network operator",
      "trigger": null,
      "role": "LF",
      "documentation": {
        "process": "docs-offline/berechnungsformel-rolle-lf-3130236f0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "incoming": "25001"
      },
      "prerequisites": [],
      "triggers_processes": [],
      "outcomes": {
        "received": {
          "pruefi": "25001",
          "description": "LF receives Berechnungsformel"
        }
      }
    },

    "EINRICHTUNG_KONFIG": {
      "id": "EINRICHTUNG_KONFIG",
      "name": "Einrichtung der Konfiguration (Rolle NB)",
      "name_de": "Einrichtung Konfiguration",
      "description": "Configuration setup triggered by NB after successful Lieferbeginn",
      "trigger": "START_EINRICHTUNG_KONFIG",
      "role": "NB",
      "documentation": {
        "process": "docs-offline/einrichtung-der-konfiguration-aufgrund-einer-zuordnung-eines-lf-zu-einer-marktlokation-oder-tranche-rolle-nb-3130506f0.md"
      },
      "pruefis": {
        "request_msb": "17134",
        "request_weiterer_msb": "17135"
      },
      "prerequisites": [
        {
          "process": "LIEFERBEGINN",
          "condition": "successful Lieferbeginn",
          "required": "always"
        }
      ],
      "triggers_processes": [
        {
          "process": "STAMMDATENAENDERUNG_MSB",
          "condition": "when configuration requires Stammdatenänderung",
          "pruefi": ["55659", "55553", "55660", "55661", "55662", "55663"],
          "triggered_by": "MSB"
        }
      ],
      "outcomes": {
        "success": {
          "description": "Configuration set up by MSB"
        }
      }
    },

    "ERSATZ_GRUNDVERSORGUNG": {
      "id": "ERSATZ_GRUNDVERSORGUNG",
      "name": "Beginn der Ersatz-/Grundversorgung (Rolle LF)",
      "name_de": "Ersatz-/Grundversorgung",
      "description": "Receive announcement of fallback/basic supply assignment (as Grundversorger)",
      "trigger": null,
      "role": "LF",
      "documentation": {
        "process": "docs-offline/beginn-der-ersatz-grundversorgung-rolle-lf-3130121f0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "announcement": "55013",
        "response_accept": "55014",
        "response_reject": "55015"
      },
      "prerequisites": [],
      "triggers_processes": [
        {
          "process": "BERECHNUNGSFORMEL",
          "condition": "on assignment",
          "pruefi": "25001",
          "triggered_by": "NB"
        },
        {
          "process": "ABRECHNUNGSDATEN_NN",
          "condition": "on assignment",
          "pruefi": "55218",
          "triggered_by": "NB"
        },
        {
          "process": "ABRECHNUNGSDATEN_BK",
          "condition": "on assignment",
          "pruefi": "55126",
          "triggered_by": "NB"
        },
        {
          "process": "STAMMDATENAENDERUNG_NB",
          "condition": "on assignment",
          "pruefi": ["55615", "55620", "55175", "55225", "55616", "55617", "55618", "55619", "55691"],
          "triggered_by": "NB"
        },
        {
          "process": "EINRICHTUNG_KONFIG",
          "condition": "on assignment",
          "pruefi": "17134",
          "triggered_by": "NB"
        }
      ],
      "outcomes": {
        "accepted": {
          "pruefi": "55014",
          "description": "E/G assignment accepted"
        },
        "rejected": {
          "pruefi": "55015",
          "ebd": ["E_0615"],
          "description": "E/G assignment rejected"
        },
        "forced": {
          "pruefi": "55013",
          "description": "Forced assignment due to no timely response"
        }
      }
    },

    "WIEDERHERSTELLUNG_ANSCHLUSS": {
      "id": "WIEDERHERSTELLUNG_ANSCHLUSS",
      "name": "Wiederherstellung der Anschlussnutzung bei Lieferbeginn",
      "name_de": "Entsperrung bei Lieferbeginn",
      "description": "Reconnection/unblocking of supply connection at Lieferbeginn",
      "trigger": "START_WIEDERHERST_LB",
      "role": "NB",
      "documentation": {
        "process": "docs-offline/wiederherstellung-der-anschlussnutzung-bei-lieferbeginn-rolle-nb-3130602f0.md"
      },
      "pruefis": {
        "info_entsperrauftrag": "21040",
        "ergebnis_entsperrauftrag": "21039"
      },
      "prerequisites": [
        {
          "process": "LIEFERBEGINN",
          "condition": "successful Lieferbeginn for blocked Marktlokation",
          "required": "always"
        }
      ],
      "triggers_processes": [],
      "outcomes": {
        "success": {
          "pruefi": "21039",
          "description": "Entsperrung successful"
        }
      }
    },

    "BEENDIGUNG_ZUORDNUNG_LFA": {
      "id": "BEENDIGUNG_ZUORDNUNG_LFA",
      "name": "Beendigung der Zuordnung des LFA (Rolle LFA)",
      "name_de": "Beendigung Zuordnung LFA",
      "description": "Receive notification of assignment termination (as old supplier)",
      "trigger": null,
      "role": "LFA",
      "documentation": {
        "process": "docs-offline/beendigung-der-zuordnung-des-lfa-zur-marktlokation-bzw-tranche-rolle-lfa-3130117f0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "notification": "55037"
      },
      "prerequisites": [
        {
          "process": "ABMELDEANFRAGE_NB_LFA",
          "condition": "after LFA responded to Abmeldeanfrage",
          "required": "typical"
        }
      ],
      "triggers_processes": [],
      "outcomes": {
        "received": {
          "pruefi": "55037",
          "description": "Assignment terminated"
        }
      }
    },

    "AUFHEBUNG_ZUORDNUNG_LFZ": {
      "id": "AUFHEBUNG_ZUORDNUNG_LFZ",
      "name": "Aufhebung der Zuordnung des LFZ (Rolle LFZ)",
      "name_de": "Aufhebung Zuordnung LFZ",
      "description": "Receive notification of future assignment cancellation (as future supplier)",
      "trigger": null,
      "role": "LFZ",
      "documentation": {
        "process": "docs-offline/aufhebung-der-zuordnung-des-lfz-zur-marktlokation-bzw-tranche-rolle-lfz-3130103f0.md"
      },
      "api": {
        "inbound": {
          "schema": "macoapp-schreiben.min.json"
        }
      },
      "pruefis": {
        "notification": "55038"
      },
      "prerequisites": [],
      "triggers_processes": [],
      "outcomes": {
        "received": {
          "pruefi": "55038",
          "description": "Future assignment cancelled"
        }
      }
    }
  },

  "business_scenarios": {
    "NEW_CUSTOMER_SIGNUP": {
      "id": "NEW_CUSTOMER_SIGNUP",
      "name": "New Customer Signs Up",
      "name_de": "Neukundenanmeldung",
      "description": "Register a new customer who wants electricity supply from you",
      "your_role": "LFN",
      "sequence": [
        {
          "step": 1,
          "process": "MALOIDENT",
          "action": "trigger",
          "condition": "if customer doesn't know MaLo-ID",
          "optional": true,
          "wait_for_response": true
        },
        {
          "step": 2,
          "process": "LIEFERBEGINN",
          "action": "trigger",
          "wait_for": ["MALOIDENT"],
          "required": true,
          "wait_for_response": true
        }
      ],
      "expected_responses_after_success": [
        {
          "process": "STAMMDATENAENDERUNG_NB",
          "from": "NB",
          "timing": "immediate"
        },
        {
          "process": "ABRECHNUNGSDATEN_BK",
          "from": "NB",
          "timing": "immediate"
        },
        {
          "process": "ABRECHNUNGSDATEN_NN",
          "from": "NB",
          "timing": "immediate",
          "condition": "for consuming Marktlokation"
        },
        {
          "process": "BERECHNUNGSFORMEL",
          "from": "NB",
          "timing": "at Zuordnungsbeginn"
        },
        {
          "process": "EINRICHTUNG_KONFIG",
          "from": "NB",
          "timing": "at Zuordnungsbeginn"
        }
      ],
      "backend_requirements": {
        "outbound_apis": ["maloident-macoapp", "macoapp-trigger"],
        "inbound_webhooks": ["maloident-lieferant", "macoapp-schreiben"],
        "data_to_collect": ["customer_info", "marktlokationsId_or_address", "contract_details", "supply_start_date"]
      }
    },

    "SUPPLIER_SWITCH_AS_NEW": {
      "id": "SUPPLIER_SWITCH_AS_NEW",
      "name": "Supplier Switch (as new supplier)",
      "name_de": "Lieferantenwechsel (als Neulieferant)",
      "description": "Customer switches from another supplier to you",
      "your_role": "LFN",
      "sequence": [
        {
          "step": 1,
          "process": "MALOIDENT",
          "action": "trigger",
          "condition": "if MaLo-ID unknown",
          "optional": true,
          "wait_for_response": true
        },
        {
          "step": 2,
          "process": "KUENDIGUNG_LFN",
          "action": "trigger",
          "description": "Cancel with old supplier on customer's behalf",
          "required": true,
          "wait_for_response": true
        },
        {
          "step": 3,
          "process": "LIEFERBEGINN",
          "action": "trigger",
          "wait_for": ["KUENDIGUNG_LFN"],
          "required": true
        }
      ],
      "expected_responses_after_success": [
        {
          "process": "INFO_EXISTING_ASSIGNMENT",
          "description": "NB may inform about existing LFA assignment (55036)"
        },
        {
          "process": "STAMMDATENAENDERUNG_NB",
          "from": "NB"
        },
        {
          "process": "ABRECHNUNGSDATEN_BK",
          "from": "NB"
        }
      ],
      "backend_requirements": {
        "outbound_apis": ["maloident-macoapp", "macoapp-trigger"],
        "inbound_webhooks": ["maloident-lieferant", "macoapp-schreiben"],
        "data_to_collect": ["customer_info", "marktlokationsId_or_address", "old_supplier_info", "contract_details"]
      }
    },

    "SUPPLIER_SWITCH_AS_OLD": {
      "id": "SUPPLIER_SWITCH_AS_OLD",
      "name": "Supplier Switch (as old supplier)",
      "name_de": "Lieferantenwechsel (als Altlieferant)",
      "description": "Customer is leaving you for another supplier",
      "your_role": "LFA",
      "sequence": [
        {
          "step": 1,
          "process": "KUENDIGUNG_LFA",
          "action": "receive",
          "description": "Receive cancellation from new supplier (LFN)",
          "required": true,
          "respond_with": ["55017", "55018"]
        },
        {
          "step": 2,
          "process": "ABMELDEANFRAGE_NB_LFA",
          "action": "receive",
          "description": "Receive request from NB to confirm end of assignment",
          "optional": true,
          "respond_with": ["55011", "55012"]
        },
        {
          "step": 3,
          "process": "BEENDIGUNG_ZUORDNUNG_LFA",
          "action": "receive",
          "description": "Receive final notification of assignment termination",
          "required": true
        },
        {
          "step": 4,
          "process": "LIEFERENDE_LF_NB",
          "action": "trigger",
          "condition": "if cancellation confirmed and Lieferende not yet started",
          "timing": "at contract end date"
        }
      ],
      "backend_requirements": {
        "inbound_webhooks": ["macoapp-schreiben"],
        "outbound_apis": ["macoapp-trigger"],
        "handlers_needed": ["kuendigung_handler", "abmeldeanfrage_handler", "beendigung_handler"]
      }
    },

    "CUSTOMER_CANCELLATION": {
      "id": "CUSTOMER_CANCELLATION",
      "name": "Customer Cancels Contract",
      "name_de": "Kundenvertragskündigung",
      "description": "Customer wants to end their electricity contract with you",
      "your_role": "LF",
      "sequence": [
        {
          "step": 1,
          "process": "LIEFERENDE_LF_NB",
          "action": "trigger",
          "description": "Notify NB of supply termination",
          "required": true,
          "wait_for_response": true
        }
      ],
      "expected_responses_after_success": [
        {
          "process": "ABRECHNUNGSDATEN_NN",
          "from": "NB"
        },
        {
          "process": "ABRECHNUNGSDATEN_BK",
          "from": "NB"
        }
      ],
      "backend_requirements": {
        "outbound_apis": ["macoapp-trigger"],
        "inbound_webhooks": ["macoapp-schreiben"],
        "data_to_collect": ["contract_end_date", "reason"]
      }
    },

    "HANDLE_FORCED_TERMINATION": {
      "id": "HANDLE_FORCED_TERMINATION",
      "name": "Handle Forced Termination from NB",
      "name_de": "Zwangsbeendigung durch NB",
      "description": "NB terminates supply (e.g., Stilllegung)",
      "your_role": "LF",
      "sequence": [
        {
          "step": 1,
          "process": "LIEFERENDE_NB_LF",
          "action": "receive",
          "description": "Receive termination announcement from NB",
          "required": true,
          "respond_with": ["55008", "55009"],
          "response_deadline": "defined by BDEW"
        }
      ],
      "expected_followup": [
        {
          "process": "ABRECHNUNGSDATEN_NN",
          "from": "NB"
        },
        {
          "process": "ABRECHNUNGSDATEN_BK",
          "from": "NB"
        }
      ],
      "backend_requirements": {
        "inbound_webhooks": ["macoapp-schreiben"],
        "handlers_needed": ["lieferende_nb_handler"]
      }
    },

    "HANDLE_EG_ASSIGNMENT": {
      "id": "HANDLE_EG_ASSIGNMENT",
      "name": "Handle Ersatz-/Grundversorgung Assignment",
      "name_de": "Ersatz-/Grundversorgung Zuweisung",
      "description": "As Grundversorger, receive fallback/basic supply assignment",
      "your_role": "LF (Grundversorger)",
      "sequence": [
        {
          "step": 1,
          "process": "ERSATZ_GRUNDVERSORGUNG",
          "action": "receive",
          "description": "Receive E/G assignment announcement from NB",
          "required": true,
          "respond_with": ["55014", "55015"],
          "response_deadline": "defined by BDEW"
        }
      ],
      "expected_followup_if_accepted": [
        {
          "process": "BERECHNUNGSFORMEL",
          "from": "NB"
        },
        {
          "process": "ABRECHNUNGSDATEN_NN",
          "from": "NB"
        },
        {
          "process": "ABRECHNUNGSDATEN_BK",
          "from": "NB"
        },
        {
          "process": "STAMMDATENAENDERUNG_NB",
          "from": "NB"
        },
        {
          "process": "EINRICHTUNG_KONFIG",
          "from": "NB"
        }
      ],
      "backend_requirements": {
        "inbound_webhooks": ["macoapp-schreiben"],
        "handlers_needed": ["eg_assignment_handler"]
      }
    },

    "MASTER_DATA_UPDATE": {
      "id": "MASTER_DATA_UPDATE",
      "name": "Send Master Data Update",
      "name_de": "Stammdatenänderung versenden",
      "description": "Send changes to customer/location data to market partners",
      "your_role": "LF",
      "sequence": [
        {
          "step": 1,
          "process": "STAMMDATENAENDERUNG_LF",
          "action": "trigger",
          "required": true
        }
      ],
      "backend_requirements": {
        "outbound_apis": ["macoapp-trigger"],
        "inbound_webhooks": ["macoapp-schreiben"],
        "data_to_collect": ["changed_data_fields"]
      }
    },

    "CANCEL_PREVIOUS_MESSAGE": {
      "id": "CANCEL_PREVIOUS_MESSAGE",
      "name": "Cancel/Reverse Previous Message",
      "name_de": "Stornierung",
      "description": "Request cancellation of a previously sent message",
      "your_role": "LF",
      "sequence": [
        {
          "step": 1,
          "process": "STORNIERUNG",
          "action": "trigger",
          "required": true,
          "data_required": ["original_message_reference"]
        }
      ],
      "backend_requirements": {
        "outbound_apis": ["macoapp-trigger"],
        "inbound_webhooks": ["macoapp-schreiben"]
      }
    }
  },

  "indexes": {
    "by_trigger": {
      "START_MALOIDENT": "MALOIDENT",
      "START_LIEFERBEGINN": "LIEFERBEGINN",
      "START_KUENDIGUNG": "KUENDIGUNG_LFN",
      "START_LIEFERENDE": "LIEFERENDE_LF_NB",
      "START_VERSAND_SDAE": "STAMMDATENAENDERUNG_LF",
      "START_STORNIERUNG": "STORNIERUNG",
      "START_EINRICHTUNG_KONFIG": "EINRICHTUNG_KONFIG",
      "START_WIEDERHERST_LB": "WIEDERHERSTELLUNG_ANSCHLUSS",
      "START_BERECHNUNGSFORMEL": "BERECHNUNGSFORMEL"
    },
    "by_pruefi": {
      "55001": {"process": "LIEFERBEGINN", "type": "request", "description": "Anmeldung verb. MaLo"},
      "55002": {"process": "LIEFERBEGINN", "type": "success", "description": "Bestätigung Anmeldung verb. MaLo"},
      "55003": {"process": "LIEFERBEGINN", "type": "rejection", "description": "Ablehnung Anmeldung verb. MaLo"},
      "55004": {"process": "LIEFERENDE_LF_NB", "type": "request", "description": "Abmeldung LF"},
      "55006": {"process": "LIEFERENDE_LF_NB", "type": "rejection", "description": "Ablehnung Abmeldung"},
      "55007": {"process": "LIEFERENDE_NB_LF", "type": "announcement", "description": "Ankündigung Beendigung"},
      "55008": {"process": "LIEFERENDE_NB_LF", "type": "response_accept", "description": "Antwort akzeptiert"},
      "55009": {"process": "LIEFERENDE_NB_LF", "type": "response_reject", "description": "Antwort abgelehnt"},
      "55010": {"process": "ABMELDEANFRAGE_NB_LFA", "type": "request", "description": "Anfrage Beendigung Zuordnung"},
      "55011": {"process": "ABMELDEANFRAGE_NB_LFA", "type": "response_accept", "description": "Bestätigung Beendigung"},
      "55012": {"process": "ABMELDEANFRAGE_NB_LFA", "type": "response_reject", "description": "Ablehnung Beendigung"},
      "55013": {"process": "ERSATZ_GRUNDVERSORGUNG", "type": "announcement", "description": "Ankündigung E/G Zuordnung"},
      "55014": {"process": "ERSATZ_GRUNDVERSORGUNG", "type": "response_accept", "description": "Antwort E/G akzeptiert"},
      "55015": {"process": "ERSATZ_GRUNDVERSORGUNG", "type": "response_reject", "description": "Antwort E/G abgelehnt"},
      "55016": {"process": "KUENDIGUNG_LFN", "type": "request", "description": "Kündigung"},
      "55017": {"process": "KUENDIGUNG_LFA", "type": "response_accept", "description": "Kündigung bestätigt"},
      "55018": {"process": "KUENDIGUNG_LFA", "type": "response_reject", "description": "Kündigung abgelehnt"},
      "55022": {"process": "STORNIERUNG", "type": "request", "description": "Anfrage Stornierung"},
      "55023": {"process": "STORNIERUNG", "type": "success", "description": "Stornierung akzeptiert"},
      "55024": {"process": "STORNIERUNG", "type": "rejection", "description": "Stornierung abgelehnt"},
      "55036": {"process": "LIEFERBEGINN", "type": "info", "description": "Info existierende Zuordnung"},
      "55037": {"process": "BEENDIGUNG_ZUORDNUNG_LFA", "type": "notification", "description": "Beendigung Zuordnung LFA"},
      "55038": {"process": "AUFHEBUNG_ZUORDNUNG_LFZ", "type": "notification", "description": "Aufhebung Zuordnung LFZ"},
      "55077": {"process": "LIEFERBEGINN", "type": "request_erzeugend", "description": "Anmeldung erz. MaLo"},
      "55078": {"process": "LIEFERBEGINN", "type": "success_erzeugend", "description": "Bestätigung Anmeldung erz. MaLo"},
      "55080": {"process": "LIEFERBEGINN", "type": "rejection_erzeugend", "description": "Ablehnung Anmeldung erz. MaLo"},
      "55126": {"process": "ABRECHNUNGSDATEN_BK", "type": "incoming", "description": "Abrechnungsdaten Bilanzkreis"},
      "55218": {"process": "ABRECHNUNGSDATEN_NN", "type": "incoming", "description": "Abrechnungsdaten Netznutzung"},
      "17134": {"process": "EINRICHTUNG_KONFIG", "type": "request", "description": "Einrichtung Konfiguration"},
      "21039": {"process": "WIEDERHERSTELLUNG_ANSCHLUSS", "type": "result", "description": "Ergebnis Entsperrauftrag"},
      "21040": {"process": "WIEDERHERSTELLUNG_ANSCHLUSS", "type": "info", "description": "Info Entsperrauftrag"},
      "25001": {"process": "BERECHNUNGSFORMEL", "type": "incoming", "description": "Berechnungsformel"}
    },
    "by_role": {
      "LF": [
        "MALOIDENT",
        "LIEFERENDE_LF_NB",
        "LIEFERENDE_NB_LF",
        "STAMMDATENAENDERUNG_LF",
        "STAMMDATENAENDERUNG_NB",
        "STAMMDATENAENDERUNG_MSB",
        "ABRECHNUNGSDATEN_NN",
        "ABRECHNUNGSDATEN_BK",
        "BERECHNUNGSFORMEL",
        "ERSATZ_GRUNDVERSORGUNG",
        "STORNIERUNG"
      ],
      "LFN": [
        "LIEFERBEGINN",
        "KUENDIGUNG_LFN"
      ],
      "LFA": [
        "KUENDIGUNG_LFA",
        "ABMELDEANFRAGE_NB_LFA",
        "BEENDIGUNG_ZUORDNUNG_LFA"
      ],
      "LFZ": [
        "AUFHEBUNG_ZUORDNUNG_LFZ"
      ]
    },
    "by_action": {
      "trigger": [
        "MALOIDENT",
        "LIEFERBEGINN",
        "KUENDIGUNG_LFN",
        "LIEFERENDE_LF_NB",
        "STAMMDATENAENDERUNG_LF",
        "STORNIERUNG"
      ],
      "receive": [
        "KUENDIGUNG_LFA",
        "LIEFERENDE_NB_LF",
        "ABMELDEANFRAGE_NB_LFA",
        "BEENDIGUNG_ZUORDNUNG_LFA",
        "AUFHEBUNG_ZUORDNUNG_LFZ",
        "STAMMDATENAENDERUNG_NB",
        "STAMMDATENAENDERUNG_MSB",
        "ABRECHNUNGSDATEN_NN",
        "ABRECHNUNGSDATEN_BK",
        "BERECHNUNGSFORMEL",
        "ERSATZ_GRUNDVERSORGUNG"
      ]
    }
  },

  "ebd_reference": {
    "E_0594": {
      "process": "MALOIDENT",
      "description": "Anfrage vom LF prüfen"
    },
    "E_0607": {
      "process": "LIEFERENDE_LF_NB",
      "description": "Prüfung Abmeldung"
    },
    "E_0609": {
      "process": "LIEFERENDE_NB_LF",
      "description": "Prüfung Lieferende NB"
    },
    "E_0610": {
      "process": "ABRECHNUNGSDATEN_NN",
      "description": "Prüfung Abrechnungsdaten NN"
    },
    "E_0611": {
      "process": "ABRECHNUNGSDATEN_BK",
      "description": "Prüfung Abrechnungsdaten BK"
    },
    "E_0614": {
      "process": "KUENDIGUNG_LFA",
      "description": "Prüfung Kündigung"
    },
    "E_0615": {
      "process": "ERSATZ_GRUNDVERSORGUNG",
      "description": "Prüfung E/G Zuordnung"
    },
    "E_0621": {
      "process": "LIEFERBEGINN",
      "description": "Prüfung Lieferbeginn - Terminprüfung"
    },
    "E_0622": {
      "process": "LIEFERBEGINN",
      "description": "Prüfung Lieferbeginn - Hauptprüfung"
    },
    "E_0623": {
      "process": "LIEFERBEGINN",
      "description": "Prüfung Lieferbeginn - Sonderfall"
    },
    "E_0624": {
      "process": "ABMELDEANFRAGE_NB_LFA",
      "description": "Prüfung Abmeldeanfrage"
    }
  }
}
